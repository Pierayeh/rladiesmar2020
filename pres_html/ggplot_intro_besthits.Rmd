---
title: "Intro To ggplot: Rladies Vancouver"
output:
  html_document:
    df_print: paged
---

This is going to be a basic overview of making your some basic plots in ggplot. We will cover 

* Scatterplots 
* Bar Plots 
* Box Plots 
* Violin Plots 
* Density Plots 
   + The aesthetics that go with them 
   
You should think of this as a "Best hits of intro to ggplot". I have gone through and collected material that I have found to be the most helpful when learning ggplot. All of these will linked as we go through.If you want any more information on a particular topic, those would be great places to start. 

First step will be to load all the libaries we might need. Make sure these are installed (if you don't know how to install packages look [here](https://www.datacamp.com/community/tutorials/r-packages-guide))

It's always a good idea to load `tidyverse`, that way if you need to clean up any data before plotting you'll be good to go. `here` is a helpful package for loading and saving files. You may not need to use it here. You need to download `ggplot`, I don't think we need to explain why. Now, `patchwork` is very exciting and I will show you exactly what it does later. 


```{r echo = T, message=FALSE}
library(tidyverse)
library(here)
library(ggplot2)
library(patchwork)
```
## A few notes on ggplot 

* The [ggplot cheatsheet](https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf)
* ggplot has 
  + data 
  + aesthetics
    + size 
    + transparency 
    + colour 
    + fill
  + geometries 
    + `geom_point()`
    + `geom_bar()`
    + `geom_boxplot()`
    + `geom_text()`
    + `geom_violin()`
    + any many more 

  

![](layers.png)


## Scatter Plots 

Scatterplots are an excellent first plot to start off with. There are lots of ways to manipulate scatterplots to give very informative figures-which you will see farther down on this page. 

The data and further information on making scatterplots can be found [here](https://www.r-graph-gallery.com/320-the-basis-of-bubble-plot.html). 

First thing first, load the data. What I have written in this chunk may not work for you. You may have to do something along the lines of `scatter=read.csv(file.choose())` and then select the `scatter.csv` from wherever you saved it on your computer. 


Its always a good idea to look at the data and make sure it uploaded properly before you start plotting. This also makes sure you know what the column names are. 
```{r}
scatter=read.csv(here("data/scatter.csv"))%>%dplyr::select(-X)
head(scatter)
```

### Basic Scatter Pot 
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point()

```

### Scatter plot with trendline 
```{r}
ggplot(scatter,aes(x=log(gdpPercap),y=lifeExp))+
  geom_point()+
  geom_smooth(method="lm")
```

### Scatter plot with different aes for the points 
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))
```

## Bar Charts and Violin Plots

What I have written in this chunk may not work for you. You may have to do something along the lines of `bar=read.csv(file.choose())` and then select the `bar_plot.csv` from wherever you saved it on your computer. 

### Bar Chart 
```{r}
bar=read.csv(here("data/bar_plot.csv"))
head(bar)
```

### Grouped Bar Chart 
```{r}
ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_bar(position="dodge",stat="identity")
```

### Stacked Bar Chart 
```{r}
ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_bar(position="stack",stat="identity")
```

### Percent Bar Chart 
```{r}
ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_bar(position="fill",stat="identity")
```


### Box and Whisker Plot 
```{r}
ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_boxplot()
```

### Violin Plot 
```{r}
ggplot(bar, aes(x=time,y=minutes,fill=year))+
  geom_violin()
```

## Density Plots

What I have written in this chunk may not work for you. You may have to do something along the lines of `density=read.csv(file.choose())` and then select the `density.csv` from wherever you saved it on your computer.
```{r}
density=read.csv(here("data/denisty.csv"))
head(density)
```
```{r}
ggplot(density, aes(x=weight,fill=sex)) + 
  geom_density()
```

```{r}
ggplot(density, aes(x=weight,fill=sex)) + 
  geom_density(alpha=0.5)
```


## Customizing your Plots
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")
```
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  theme_bw()
```
```{r}
scatter_bw=ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  ggtitle(("theme_bw"))+
  theme_bw()+
  theme(legend.position = "none")
scatter_light=ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  ggtitle("theme_classic")+
  theme_classic()+
  theme(legend.position = "none")
scatter_dark=ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  ggtitle("theme_dark")+
  theme_dark()+
  theme(legend.position = "none")
scatter_minimal=ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  ggtitle("theme_minimal")+
  theme_minimal()+
  theme(legend.position = "none")


```

Patchwork 
```{r}
(scatter_bw|scatter_light)/(scatter_dark|scatter_minimal)
```
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  theme_bw()+
  theme(panel.grid = element_blank())
```
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())
```
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())
```

```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  scale_colour_viridis_d()+
  ggtitle("Scatterplot with Viridis Colouring")+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())
```
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  scale_colour_brewer(palette = "Paired")+
  ggtitle("Scatterplot with Colour Brewer")+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())
```

If you're going to get into manual colouring look [here](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf)
```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  scale_colour_manual(values=c("orangered3","slateblue","lightseagreen","orchid3","sienna2"))+
  ggtitle("Scatterplot with Manual Colours")+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())
```

```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  scale_colour_viridis_d()+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank())+
  facet_grid(~continent)
```

```{r}
ggplot(scatter,aes(x=gdpPercap,y=lifeExp))+
  geom_point(aes(colour=continent,size=pop))+
  scale_colour_viridis_d()+
  xlab(" GDP Per Capita")+
  ylab("Life Expectancy")+
  guides(colour=guide_legend(title="Continent"),size=guide_legend(title="Population"))+
  theme_bw()+
  theme(panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        axis.text.x = element_text(angle=45,vjust=0.5))+
  facet_grid(~continent)
```

### Changing Factor Levels
```{r}
bar_ofl=ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_bar(position="dodge",stat="identity")
bar$time <- factor(bar$time,levels = c("week2","midterm","final"))
bar_rfl=ggplot(bar, aes(x=time,y=minutes,fill=year))+geom_bar(position="dodge",stat="identity")
(bar_ofl|bar_rfl)
```


```{r eval=FALSE}
merged_plot <- ggplot(merged_data_na,aes(x=Enzyme_isoform,y= reorder(Name, -(Diameter)),size= isoform_count,shape=ome, colour= taxa))
  geom_point()+
  xlab("Gene Family")+
  ylab("Taxon")+
  scale_x_discrete(position ="top")+
  scale_radius(range=c(2,13),breaks=c(2,4,6,8,10,12,15,20))+
  scale_shape_manual(values = c(16, 18),"Data Type")+
  scale_color_manual(values = cols)+
  guides(size=guide_legend(title="Isoform Count"),
         shape=guide_legend(override.aes = list(size=3)), 
         colour=guide_legend(override.aes = list(size=3),(title = "Taxa")))+
  theme_bw()+
  theme(panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.y=element_text(face="italic",size=12),
        axis.text.x=element_text(size=12,angle=90),
        axis.text=element_text(size=12),
        axis.title=element_text(size=14,face="bold"))+
  facet_grid(~Enzyme_parent_ASA, scales = "free", space = "free")
```

## Trouble shooting 

* check the order of your layers 
* check the class of the columns you are trying to use using `class()`
* check the factor levels with `levels()`
* to check how many of each category you have use `table(df$col)`


